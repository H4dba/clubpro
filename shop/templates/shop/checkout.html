{% extends "base.html" %}
{% load widget_tweaks %}

{% block title %}Checkout - Loja ClubPro{% endblock %}

{% block content %}
<div class="container my-3 my-md-5">
    <h2 class="mb-3 mb-md-4 h3 h-md-2">
        <i class="fas fa-credit-card me-2"></i>
        Finalizar Compra
    </h2>
    
    <div class="row">
        <div class="col-12 col-lg-8 mb-4 mb-lg-0">
            <div class="card shadow-sm mb-4">
                <div class="card-header bg-primary text-white">
                    <h5 class="mb-0 h6 h-md-5">Informações de Entrega</h5>
                </div>
                <div class="card-body">
                    <form method="post">
                        {% csrf_token %}
                        
                        <div class="row g-2 g-md-3 mb-3">
                            <div class="col-12 col-md-6">
                                <label class="form-label small small-md-normal">Nome Completo *</label>
                                <input type="text" name="customer_name" class="form-control form-control-sm form-control-md-normal" 
                                       value="{{ member_info.name|default:'' }}" required>
                            </div>
                            <div class="col-12 col-md-6">
                                <label class="form-label small small-md-normal">E-mail *</label>
                                <input type="email" name="customer_email" class="form-control form-control-sm form-control-md-normal" 
                                       value="{{ member_info.email|default:user.email|default:'' }}" required>
                            </div>
                        </div>
                        
                        <div class="row g-2 g-md-3 mb-3">
                            <div class="col-12 col-md-6">
                                <label class="form-label small small-md-normal">Telefone *</label>
                                <input type="text" name="customer_phone" class="form-control form-control-sm form-control-md-normal" 
                                       value="{{ member_info.phone|default:'' }}" required>
                            </div>
                            <div class="col-12 col-md-6">
                                <label class="form-label small small-md-normal">CEP *</label>
                                <input type="text" name="shipping_zip" class="form-control form-control-sm form-control-md-normal" required>
                            </div>
                        </div>
                        
                        <div class="mb-3">
                            <label class="form-label small small-md-normal">Endereço *</label>
                            <input type="text" name="shipping_address" class="form-control form-control-sm form-control-md-normal" 
                                   value="{{ member_info.address|default:'' }}" required>
                        </div>
                        
                        <div class="row g-2 g-md-3 mb-3">
                            <div class="col-12 col-md-6">
                                <label class="form-label small small-md-normal">Cidade *</label>
                                <input type="text" name="shipping_city" class="form-control form-control-sm form-control-md-normal" required>
                            </div>
                            <div class="col-12 col-md-6">
                                <label class="form-label small small-md-normal">Estado *</label>
                                <select name="shipping_state" class="form-select form-select-sm form-select-md-normal" required>
                                    <option value="">Selecione</option>
                                    <option value="AC">AC</option>
                                    <option value="AL">AL</option>
                                    <option value="AP">AP</option>
                                    <option value="AM">AM</option>
                                    <option value="BA">BA</option>
                                    <option value="CE">CE</option>
                                    <option value="DF">DF</option>
                                    <option value="ES">ES</option>
                                    <option value="GO">GO</option>
                                    <option value="MA">MA</option>
                                    <option value="MT">MT</option>
                                    <option value="MS">MS</option>
                                    <option value="MG">MG</option>
                                    <option value="PA">PA</option>
                                    <option value="PB">PB</option>
                                    <option value="PR">PR</option>
                                    <option value="PE">PE</option>
                                    <option value="PI">PI</option>
                                    <option value="RJ">RJ</option>
                                    <option value="RN">RN</option>
                                    <option value="RS">RS</option>
                                    <option value="RO">RO</option>
                                    <option value="RR">RR</option>
                                    <option value="SC">SC</option>
                                    <option value="SP">SP</option>
                                    <option value="SE">SE</option>
                                    <option value="TO">TO</option>
                                </select>
                            </div>
                        </div>
                        
                        <div class="mb-3">
                            <label class="form-label small small-md-normal">Observações</label>
                            <textarea name="notes" class="form-control form-control-sm form-control-md-normal" rows="3"></textarea>
                        </div>
                        
                        <div class="mb-3">
                            <label class="form-label small small-md-normal">Método de Pagamento *</label>
                            <select name="payment_method" class="form-select form-select-sm form-select-md-normal" required>
                                <option value="">Selecione</option>
                                <option value="pix">PIX</option>
                                <option value="credit_card">Cartão de Crédito</option>
                                <option value="debit_card">Cartão de Débito</option>
                                <option value="bank_transfer">Transferência Bancária</option>
                            </select>
                        </div>
                        
                        <button type="submit" class="btn btn-gold w-100 btn-sm btn-md-lg">
                            <i class="fas fa-check me-2"></i>Confirmar Pedido
                        </button>
                    </form>
                </div>
            </div>
        </div>
        
        <div class="col-12 col-lg-4">
            <div class="card shadow-sm sticky-top" style="top: 20px;">
                <div class="card-header bg-primary text-white">
                    <h5 class="mb-0 h6 h-md-5">Resumo do Pedido</h5>
                </div>
                <div class="card-body">
                    {% for item in cart_items %}
                    <div class="d-flex justify-content-between mb-2 small small-md-normal">
                        <span class="text-truncate me-2">{{ item.product.name }} x{{ item.quantity }}</span>
                        <strong class="text-nowrap">R$ {{ item.get_total }}</strong>
                    </div>
                    {% endfor %}
                    <hr>
                    <div class="d-flex justify-content-between">
                        <span class="h6 h-md-5 mb-0">Total:</span>
                        <strong class="h6 h-md-5 text-primary mb-0">R$ {{ cart.get_total }}</strong>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
    .h-md-2 { font-size: 2rem !important; }
    .h-md-5 { font-size: 1.25rem !important; }
    .h-md-6 { font-size: 1rem !important; }
    .small-md-normal { font-size: 1rem !important; }
    .form-control-md-normal { font-size: 1rem; padding: 0.375rem 0.75rem; }
    .form-select-md-normal { font-size: 1rem; padding: 0.375rem 2.25rem 0.375rem 0.75rem; }
    .btn-md-lg { font-size: 1rem; padding: 0.5rem 1rem; }
    
    @media (max-width: 767px) {
        .h-md-2 { font-size: 1.5rem !important; }
        .h-md-5 { font-size: 1rem !important; }
        .h-md-6 { font-size: 0.875rem !important; }
        .small-md-normal { font-size: 0.875rem !important; }
        .form-control-md-normal { font-size: 0.875rem; padding: 0.25rem 0.5rem; }
        .form-select-md-normal { font-size: 0.875rem; padding: 0.25rem 1.75rem 0.25rem 0.5rem; }
        .btn-md-lg { font-size: 0.875rem; padding: 0.375rem 0.75rem; }
        
        .sticky-top {
            position: relative !important;
            top: 0 !important;
        }
    }
</style>
{% endblock %}
