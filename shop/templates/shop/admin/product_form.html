{% extends "base.html" %}
{% load widget_tweaks %}

{% block title %}{{ title }} - Loja{% endblock %}

{% block content %}
<div class="container my-3 my-md-5">
    <div class="row justify-content-center">
        <div class="col-12 col-lg-10">
            <div class="card shadow-sm">
                <div class="card-header bg-primary text-white">
                    <h4 class="mb-0 h5 h-md-4">
                        <i class="fas fa-{% if product %}edit{% else %}plus{% endif %} me-2"></i>
                        {{ title }}
                    </h4>
                </div>
                <div class="card-body">
                    <form method="post" enctype="multipart/form-data">
                        {% csrf_token %}
                        
                        <div class="row">
                            <div class="col-12 col-md-8">
                                <h5 class="mb-3 h6 h-md-5">Informações Básicas</h5>
                                
                                <div class="mb-3">
                                    <label class="form-label small small-md-normal">Nome do Produto *</label>
                                    {{ form.name|add_class:"form-control form-control-sm form-control-md-normal" }}
                                    {% if form.name.errors %}
                                    <div class="text-danger small">{{ form.name.errors }}</div>
                                    {% endif %}
                                </div>
                                
                                <div class="mb-3">
                                    <label class="form-label small small-md-normal">Descrição Curta</label>
                                    {{ form.short_description|add_class:"form-control form-control-sm form-control-md-normal" }}
                                    <small class="form-text text-muted small">Aparece na listagem de produtos</small>
                                </div>
                                
                                <div class="mb-3">
                                    <label class="form-label small small-md-normal">Descrição Completa *</label>
                                    {{ form.description|add_class:"form-control form-control-sm form-control-md-normal" }}
                                    {% if form.description.errors %}
                                    <div class="text-danger small">{{ form.description.errors }}</div>
                                    {% endif %}
                                </div>
                                
                                <div class="mb-3">
                                    <label class="form-label small small-md-normal">Categoria</label>
                                    {{ form.category|add_class:"form-select form-select-sm form-select-md-normal" }}
                                </div>
                                
                                <h5 class="mb-3 mt-4 h6 h-md-5">Preços</h5>
                                
                                <div class="row g-2 g-md-3">
                                    <div class="col-12 col-md-6">
                                        <div class="mb-3">
                                            <label class="form-label small small-md-normal">Preço *</label>
                                            <div class="input-group input-group-sm input-group-md-normal">
                                                <span class="input-group-text">R$</span>
                                                {{ form.price|add_class:"form-control" }}
                                            </div>
                                            {% if form.price.errors %}
                                            <div class="text-danger small">{{ form.price.errors }}</div>
                                            {% endif %}
                                        </div>
                                    </div>
                                    <div class="col-12 col-md-6">
                                        <div class="mb-3">
                                            <label class="form-label small small-md-normal">Desconto para Sócios (%)</label>
                                            <div class="input-group input-group-sm input-group-md-normal">
                                                {{ form.member_discount_percent|add_class:"form-control" }}
                                                <span class="input-group-text">%</span>
                                            </div>
                                            <small class="form-text text-muted small">Ex: 10 = 10% de desconto</small>
                                        </div>
                                    </div>
                                </div>
                                
                                <h5 class="mb-3 mt-4 h6 h-md-5">Estoque</h5>
                                
                                <div class="row g-2 g-md-3">
                                    <div class="col-12 col-md-6">
                                        <div class="mb-3">
                                            <label class="form-label small small-md-normal">Quantidade em Estoque *</label>
                                            {{ form.stock|add_class:"form-control form-control-sm form-control-md-normal" }}
                                            {% if form.stock.errors %}
                                            <div class="text-danger small">{{ form.stock.errors }}</div>
                                            {% endif %}
                                        </div>
                                    </div>
                                    <div class="col-12 col-md-6">
                                        <div class="mb-3">
                                            <label class="form-label small small-md-normal">SKU</label>
                                            {{ form.sku|add_class:"form-control form-control-sm form-control-md-normal" }}
                                            <small class="form-text text-muted small">Código único (gerado automaticamente se vazio)</small>
                                        </div>
                                    </div>
                                </div>
                                
                                <h5 class="mb-3 mt-4 h6 h-md-5">Imagem</h5>
                                
                                <div class="mb-3">
                                    <label class="form-label small small-md-normal">Imagem Principal</label>
                                    {% if product and product.main_image %}
                                    <div class="mb-2">
                                        <img src="{{ product.main_image.url }}" alt="{{ product.name }}" style="max-height: 150px; max-width: 100%;" class="img-thumbnail">
                                    </div>
                                    {% endif %}
                                    {{ form.main_image|add_class:"form-control form-control-sm form-control-md-normal" }}
                                    {% if form.main_image.errors %}
                                    <div class="text-danger small">{{ form.main_image.errors }}</div>
                                    {% endif %}
                                </div>
                                
                                <h5 class="mb-3 mt-4 h6 h-md-5">Configurações</h5>
                                
                                <div class="mb-3">
                                    <div class="form-check form-switch">
                                        {{ form.is_active|add_class:"form-check-input" }}
                                        <label class="form-check-label small small-md-normal" for="{{ form.is_active.id_for_label }}">
                                            Produto Ativo
                                        </label>
                                    </div>
                                    <small class="form-text text-muted small">Produtos inativos não aparecem na loja</small>
                                </div>
                                
                                <div class="mb-3">
                                    <div class="form-check form-switch">
                                        {{ form.is_featured|add_class:"form-check-input" }}
                                        <label class="form-check-label small small-md-normal" for="{{ form.is_featured.id_for_label }}">
                                            Produto em Destaque
                                        </label>
                                    </div>
                                    <small class="form-text text-muted small">Produtos em destaque aparecem na página inicial</small>
                                </div>
                            </div>
                            
                            <div class="col-12 col-md-4 mt-4 mt-md-0">
                                <div class="card bg-light">
                                    <div class="card-body">
                                        <h6 class="card-title small small-md-normal">Informações Adicionais</h6>
                                        
                                        <div class="mb-3">
                                            <label class="form-label small small-md-normal">URL Amigável (Slug)</label>
                                            {{ form.slug|add_class:"form-control form-control-sm form-control-md-normal" }}
                                            <small class="form-text text-muted small">Deixe vazio para gerar automaticamente</small>
                                        </div>
                                        
                                        <div class="mb-3">
                                            <label class="form-label small small-md-normal">Título SEO</label>
                                            {{ form.meta_title|add_class:"form-control form-control-sm form-control-md-normal" }}
                                        </div>
                                        
                                        <div class="mb-3">
                                            <label class="form-label small small-md-normal">Descrição SEO</label>
                                            {{ form.meta_description|add_class:"form-control form-control-sm form-control-md-normal" }}
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="d-flex flex-column flex-md-row justify-content-between gap-2 mt-4">
                            <a href="{% url 'shop:admin_product_list' %}" class="btn btn-secondary btn-sm btn-md-normal w-100 w-md-auto">
                                <i class="fas fa-arrow-left me-2"></i>Cancelar
                            </a>
                            <button type="submit" class="btn btn-primary btn-sm btn-md-normal w-100 w-md-auto">
                                <i class="fas fa-save me-2"></i>Salvar Produto
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
    .h-md-4 { font-size: 1.5rem !important; }
    .h-md-5 { font-size: 1.25rem !important; }
    .h-md-6 { font-size: 1rem !important; }
    .small-md-normal { font-size: 1rem !important; }
    .form-control-md-normal { font-size: 1rem; padding: 0.375rem 0.75rem; }
    .form-select-md-normal { font-size: 1rem; padding: 0.375rem 2.25rem 0.375rem 0.75rem; }
    .input-group-md-normal { font-size: 1rem; }
    .input-group-md-normal .form-control { font-size: 1rem; padding: 0.375rem 0.75rem; }
    .input-group-md-normal .input-group-text { font-size: 1rem; padding: 0.375rem 0.75rem; }
    .btn-md-normal { font-size: 1rem; padding: 0.375rem 0.75rem; }
    
    @media (max-width: 767px) {
        .h-md-4 { font-size: 1.25rem !important; }
        .h-md-5 { font-size: 1rem !important; }
        .h-md-6 { font-size: 0.875rem !important; }
        .small-md-normal { font-size: 0.875rem !important; }
        .form-control-md-normal { font-size: 0.875rem; padding: 0.25rem 0.5rem; }
        .form-select-md-normal { font-size: 0.875rem; padding: 0.25rem 1.75rem 0.25rem 0.5rem; }
        .input-group-md-normal { font-size: 0.875rem; }
        .input-group-md-normal .form-control { font-size: 0.875rem; padding: 0.25rem 0.5rem; }
        .input-group-md-normal .input-group-text { font-size: 0.875rem; padding: 0.25rem 0.5rem; }
        .btn-md-normal { font-size: 0.875rem; padding: 0.25rem 0.5rem; }
    }
</style>
{% endblock %}
